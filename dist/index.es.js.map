{"version":3,"file":"index.es.js","sources":["../src/hooks/useLayoutEffect.tsx","../src/utils.ts","../src/hooks/useSnapPoints.tsx","../src/machines/overlay.ts","../src/BottomSheet.tsx","../src/hooks/useReady.tsx","../src/hooks/useReducedMotion.tsx","../src/hooks/useSpring.tsx","../src/hooks/useScrollLock.tsx","../src/hooks/useAriaHider.tsx","../src/hooks/useFocusTrap.tsx","../src/hooks/useSpringInterpolations.tsx","../src/index.tsx"],"sourcesContent":["import { useEffect, useLayoutEffect as useLayoutEffectSafely } from 'react'\r\n\r\n// Ensure the name used in components is useLayoutEffect so the eslint react hooks plugin works\r\nexport const useLayoutEffect =\r\n  typeof window !== 'undefined' ? useLayoutEffectSafely : useEffect\r\n","/* eslint-disable no-self-compare */\r\n\r\n// stolen from lodash\r\nexport function clamp(number: number, lower: number, upper: number) {\r\n  number = +number\r\n  lower = +lower\r\n  upper = +upper\r\n  lower = lower === lower ? lower : 0\r\n  upper = upper === upper ? upper : 0\r\n  if (number === number) {\r\n    number = number <= upper ? number : upper\r\n    number = number >= lower ? number : lower\r\n  }\r\n  return number\r\n}\r\n\r\n// Mwahaha easiest way to filter out NaN I ever saw! >:3\r\nexport function deleteNaN(arr) {\r\n  const set = new Set(arr)\r\n  set.delete(NaN)\r\n  return [...set]\r\n}\r\n\r\nexport function roundAndCheckForNaN(unrounded) {\r\n  const rounded = Math.round(unrounded)\r\n  if (Number.isNaN(unrounded)) {\r\n    throw new TypeError(\r\n      'Found a NaN! Check your snapPoints / defaultSnap / snapTo '\r\n    )\r\n  }\r\n\r\n  return rounded\r\n}\r\n\r\n// Validate, sanitize, round and dedupe snap points, as well as extracting the minSnap and maxSnap points\r\nexport function processSnapPoints(unsafeSnaps: number | number[], maxHeight) {\r\n  const safeSnaps = [].concat(unsafeSnaps).map(roundAndCheckForNaN)\r\n\r\n  const snapPointsDedupedSet = safeSnaps.reduce((acc, snapPoint) => {\r\n    acc.add(clamp(snapPoint, 0, maxHeight))\r\n    return acc\r\n  }, new Set<number>())\r\n\r\n  const snapPoints = Array.from(snapPointsDedupedSet)\r\n\r\n  const minSnap = Math.min(...snapPoints)\r\n  if (Number.isNaN(minSnap)) {\r\n    throw new TypeError('minSnap is NaN')\r\n  }\r\n  const maxSnap = Math.max(...snapPoints)\r\n  if (Number.isNaN(maxSnap)) {\r\n    throw new TypeError('maxSnap is NaN')\r\n  }\r\n\r\n  return {\r\n    snapPoints,\r\n    minSnap,\r\n    maxSnap,\r\n  }\r\n}\r\n\r\nexport const debugging =\r\n  process.env.NODE_ENV === 'development' && typeof window !== 'undefined'\r\n    ? window.location.search === '?debug'\r\n    : false\r\n","import React, {\r\n  useCallback,\r\n  useDebugValue,\r\n  useEffect,\r\n  useMemo,\r\n  useRef,\r\n  useState,\r\n} from 'react'\r\nimport { ResizeObserver, ResizeObserverEntry } from '@juggle/resize-observer'\r\nimport type { defaultSnapProps, ResizeSource, snapPoints } from '../types'\r\nimport { processSnapPoints, roundAndCheckForNaN } from '../utils'\r\nimport { useReady } from './useReady'\r\nimport { ResizeObserverOptions } from '@juggle/resize-observer/lib/ResizeObserverOptions'\r\nimport { useLayoutEffect } from './useLayoutEffect'\r\n\r\nexport function useSnapPoints({\r\n  contentRef,\r\n  controlledMaxHeight,\r\n  footerEnabled,\r\n  footerRef,\r\n  getSnapPoints,\r\n  headerEnabled,\r\n  headerRef,\r\n  heightRef,\r\n  lastSnapRef,\r\n  ready,\r\n  registerReady,\r\n  resizeSourceRef,\r\n}: {\r\n  contentRef: React.RefObject<Element>\r\n  controlledMaxHeight?: number\r\n  footerEnabled: boolean\r\n  footerRef: React.RefObject<Element>\r\n  getSnapPoints: snapPoints\r\n  headerEnabled: boolean\r\n  headerRef: React.RefObject<Element>\r\n  heightRef: React.RefObject<number>\r\n  lastSnapRef: React.RefObject<number>\r\n  ready: boolean\r\n  registerReady: ReturnType<typeof useReady>['registerReady']\r\n  resizeSourceRef: React.MutableRefObject<ResizeSource>\r\n}) {\r\n  const { maxHeight, minHeight, headerHeight, footerHeight } = useDimensions({\r\n    contentRef: contentRef,\r\n    controlledMaxHeight,\r\n    footerEnabled,\r\n    footerRef,\r\n    headerEnabled,\r\n    headerRef,\r\n    registerReady,\r\n    resizeSourceRef,\r\n  })\r\n\r\n  const { snapPoints, minSnap, maxSnap } = processSnapPoints(\r\n    ready\r\n      ? getSnapPoints({\r\n          height: heightRef.current,\r\n          footerHeight,\r\n          headerHeight,\r\n          minHeight,\r\n          maxHeight,\r\n        })\r\n      : [0],\r\n    maxHeight\r\n  )\r\n  //\r\n\r\n  // @TODO investigate the gains from memoizing this\r\n  function findSnap(\r\n    numberOrCallback: number | ((state: defaultSnapProps) => number)\r\n  ) {\r\n    let unsafeSearch: number\r\n    if (typeof numberOrCallback === 'function') {\r\n      unsafeSearch = numberOrCallback({\r\n        footerHeight,\r\n        headerHeight,\r\n        height: heightRef.current,\r\n        minHeight,\r\n        maxHeight,\r\n        snapPoints,\r\n        lastSnap: lastSnapRef.current,\r\n      })\r\n    } else {\r\n      unsafeSearch = numberOrCallback\r\n    }\r\n    const querySnap = roundAndCheckForNaN(unsafeSearch)\r\n    return snapPoints.reduce(\r\n      (prev, curr) =>\r\n        Math.abs(curr - querySnap) < Math.abs(prev - querySnap) ? curr : prev,\r\n      minSnap\r\n    )\r\n  }\r\n\r\n  useDebugValue(`minSnap: ${minSnap}, maxSnap:${maxSnap}`)\r\n\r\n  return { minSnap, maxSnap, findSnap, maxHeight }\r\n}\r\n\r\nfunction useDimensions({\r\n  contentRef,\r\n  controlledMaxHeight,\r\n  footerEnabled,\r\n  footerRef,\r\n  headerEnabled,\r\n  headerRef,\r\n  registerReady,\r\n  resizeSourceRef,\r\n}: {\r\n  contentRef: React.RefObject<Element>\r\n  controlledMaxHeight?: number\r\n  footerEnabled: boolean\r\n  footerRef: React.RefObject<Element>\r\n  headerEnabled: boolean\r\n  headerRef: React.RefObject<Element>\r\n  registerReady: ReturnType<typeof useReady>['registerReady']\r\n  resizeSourceRef: React.MutableRefObject<ResizeSource>\r\n}) {\r\n  const setReady = useMemo(() => registerReady('contentHeight'), [\r\n    registerReady,\r\n  ])\r\n  const maxHeight = useMaxHeight(\r\n    controlledMaxHeight,\r\n    registerReady,\r\n    resizeSourceRef\r\n  )\r\n\r\n  // @TODO probably better to forward props instead of checking refs to decide if it's enabled\r\n  const headerHeight = useElementSizeObserver(headerRef, {\r\n    label: 'headerHeight',\r\n    enabled: headerEnabled,\r\n    resizeSourceRef,\r\n  })\r\n  const contentHeight = useElementSizeObserver(contentRef, {\r\n    label: 'contentHeight',\r\n    enabled: true,\r\n    resizeSourceRef,\r\n  })\r\n  const footerHeight = useElementSizeObserver(footerRef, {\r\n    label: 'footerHeight',\r\n    enabled: footerEnabled,\r\n    resizeSourceRef,\r\n  })\r\n  const minHeight =\r\n    Math.min(maxHeight - headerHeight - footerHeight, contentHeight) +\r\n    headerHeight +\r\n    footerHeight\r\n\r\n  useDebugValue(`minHeight: ${minHeight}`)\r\n\r\n  const ready = contentHeight > 0\r\n  useEffect(() => {\r\n    if (ready) {\r\n      setReady()\r\n    }\r\n  }, [ready, setReady])\r\n\r\n  return {\r\n    maxHeight,\r\n    minHeight,\r\n    headerHeight,\r\n    footerHeight,\r\n  }\r\n}\r\n\r\nconst observerOptions: ResizeObserverOptions = {\r\n  // Respond to changes to padding, happens often on iOS when using env(safe-area-inset-bottom)\r\n  // And the user hides or shows the Safari browser toolbar\r\n  box: 'border-box',\r\n}\r\n/**\r\n * Hook for determining the size of an element using the Resize Observer API.\r\n *\r\n * @param ref - A React ref to an element\r\n */\r\nfunction useElementSizeObserver(\r\n  ref: React.RefObject<Element>,\r\n  {\r\n    label,\r\n    enabled,\r\n    resizeSourceRef,\r\n  }: {\r\n    label: string\r\n    enabled: boolean\r\n    resizeSourceRef: React.MutableRefObject<ResizeSource>\r\n  }\r\n): number {\r\n  let [size, setSize] = useState(0)\r\n\r\n  useDebugValue(`${label}: ${size}`);\r\n//   \r\n\r\n  const handleResize = useCallback(\r\n    (entries: ResizeObserverEntry[]) => {\r\n      // we only observe one element, so accessing the first entry here is fine\r\n      setSize(entries[0].borderBoxSize[0].blockSize)\r\n      resizeSourceRef.current = 'element'\r\n    },\r\n    [resizeSourceRef]\r\n  )\r\n\r\n  useLayoutEffect(() => {\r\n    if (!ref.current || !enabled) {\r\n      return\r\n    }\r\n\r\n    const resizeObserver = new ResizeObserver(handleResize)\r\n    resizeObserver.observe(ref.current, observerOptions)\r\n\r\n    return () => {\r\n      resizeObserver.disconnect()\r\n    }\r\n  }, [ref, handleResize, enabled])\r\n\r\n  return enabled ? size : 0\r\n}\r\n\r\n// Blazingly keep track of the current viewport height without blocking the thread, keeping that sweet 60fps on smartphones\r\nfunction useMaxHeight(\r\n  controlledMaxHeight,\r\n  registerReady: ReturnType<typeof useReady>['registerReady'],\r\n  resizeSourceRef: React.MutableRefObject<ResizeSource>\r\n) {\r\n  const setReady = useMemo(() => registerReady('maxHeight'), [registerReady])\r\n  const [maxHeight, setMaxHeight] = useState(() =>\r\n    roundAndCheckForNaN(controlledMaxHeight) || typeof window !== 'undefined'\r\n      ? window.innerHeight\r\n      : 0\r\n  )\r\n  const ready = maxHeight > 0\r\n  const raf = useRef(0)\r\n\r\n  useDebugValue(controlledMaxHeight ? 'controlled' : 'auto')\r\n\r\n  useEffect(() => {\r\n    if (ready) {\r\n      setReady()\r\n    }\r\n  }, [ready, setReady])\r\n\r\n  useLayoutEffect(() => {\r\n    // Bail if the max height is a controlled prop\r\n    if (controlledMaxHeight) {\r\n      setMaxHeight(roundAndCheckForNaN(controlledMaxHeight))\r\n      resizeSourceRef.current = 'maxheightprop'\r\n\r\n      return\r\n    }\r\n\r\n    const handleResize = () => {\r\n      if (raf.current) {\r\n        // bail to throttle the amount of resize changes\r\n        return\r\n      }\r\n\r\n      // throttle state changes using rAF\r\n      raf.current = requestAnimationFrame(() => {\r\n        setMaxHeight(window.innerHeight)\r\n        resizeSourceRef.current = 'window'\r\n\r\n        raf.current = 0\r\n      })\r\n    }\r\n    window.addEventListener('resize', handleResize)\r\n    setMaxHeight(window.innerHeight)\r\n    resizeSourceRef.current = 'window'\r\n    setReady()\r\n\r\n    return () => {\r\n      window.removeEventListener('resize', handleResize)\r\n      cancelAnimationFrame(raf.current)\r\n    }\r\n  }, [controlledMaxHeight, setReady, resizeSourceRef])\r\n\r\n  return maxHeight\r\n}\r\n","import { Machine, assign } from 'xstate'\r\n\r\n// This is the root machine, composing all the other machines and is the brain of the bottom sheet\r\n\r\ninterface OverlayStateSchema {\r\n  states: {\r\n    // the overlay usually starts in the closed position\r\n    closed: {}\r\n    opening: {\r\n      states: {\r\n        // Used to fire off the springStart event\r\n        start: {}\r\n        // Decide how to transition to the open state based on what the initialState is\r\n        transition: {}\r\n        // Fast enter animation, sheet is open by default\r\n        immediately: {\r\n          states: {\r\n            open: {}\r\n            activating: {}\r\n          }\r\n        }\r\n        smoothly: {\r\n          states: {\r\n            // This state only happens when the overlay should start in an open state, instead of animating from the bottom\r\n            // openImmediately: {}\r\n            // visuallyHidden will render the overlay in the open state, but with opacity 0\r\n            // doing this solves two problems:\r\n            // on Android focusing an input element will trigger the softkeyboard to show up, which will change the viewport height\r\n            // on iOS the focus event will break the view by triggering a scrollIntoView event if focus happens while the overlay is below the viewport and body got overflow:hidden\r\n            // by rendering things with opacity 0 we ensure keyboards and scrollIntoView all happen in a way that match up with what the sheet will look like.\r\n            // we can then move it to the opening position below the viewport, and animate it into view without worrying about height changes or scrolling overflow:hidden events\r\n            visuallyHidden: {}\r\n            // In this state we're activating focus traps, scroll locks and more, this will sometimes trigger soft keyboards and scrollIntoView\r\n            // @TODO we might want to add a delay here before proceeding to open, to give android and iOS enough time to adjust the viewport when focusing an interactive element\r\n            activating: {}\r\n            // Animates from the bottom\r\n            open: {}\r\n          }\r\n        }\r\n        // Used to fire off the springEnd event\r\n        end: {}\r\n        // And finally we're ready to transition to open\r\n        done: {}\r\n      }\r\n    }\r\n    open: {}\r\n    // dragging responds to user gestures, which may interrupt the opening state, closing state or snapping\r\n    // when interrupting an opening event, it fires onSpringEnd(OPEN) before onSpringStart(DRAG)\r\n    // when interrupting a closing event, it fires onSpringCancel(CLOSE) before onSpringStart(DRAG)\r\n    // when interrupting a dragging event, it fires onSpringCancel(SNAP) before onSpringStart(DRAG)\r\n    dragging: {}\r\n    // snapping happens whenever transitioning to a new snap point, often after dragging\r\n    snapping: {\r\n      states: {\r\n        start: {}\r\n        snappingSmoothly: {}\r\n        end: {}\r\n        done: {}\r\n      }\r\n    }\r\n    resizing: {\r\n      states: {\r\n        start: {}\r\n        resizingSmoothly: {}\r\n        end: {}\r\n        done: {}\r\n      }\r\n    }\r\n    closing: {\r\n      states: {\r\n        start: {}\r\n        deactivating: {}\r\n        closingSmoothly: {}\r\n        end: {}\r\n        done: {}\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\ntype OverlayEvent =\r\n  | { type: 'OPEN' }\r\n  | {\r\n      type: 'SNAP'\r\n      payload: {\r\n        y: number\r\n        velocity: number\r\n        source: 'dragging' | 'custom' | string\r\n      }\r\n    }\r\n  | { type: 'CLOSE' }\r\n  | { type: 'DRAG' }\r\n  | { type: 'RESIZE' }\r\n\r\n// The context (extended state) of the machine\r\ninterface OverlayContext {\r\n  initialState: 'OPEN' | 'CLOSED'\r\n  snapSource?: 'string'\r\n}\r\nfunction sleep(ms = 1000) {\r\n  return new Promise((resolve) => setTimeout(resolve, ms))\r\n}\r\n\r\nconst cancelOpen = {\r\n  CLOSE: { target: '#overlay.closing', actions: 'onOpenCancel' },\r\n}\r\nconst openToDrag = {\r\n  DRAG: { target: '#overlay.dragging', actions: 'onOpenEnd' },\r\n}\r\nconst openToResize = {\r\n  RESIZE: { target: '#overlay.resizing', actions: 'onOpenEnd' },\r\n}\r\n\r\nconst initiallyOpen = ({ initialState }) => initialState === 'OPEN'\r\nconst initiallyClosed = ({ initialState }) => initialState === 'CLOSED'\r\n\r\n// Copy paste the machine into https://xstate.js.org/viz/ to make sense of what's going on in here ;)\r\n\r\nexport const overlayMachine = Machine<\r\n  OverlayContext,\r\n  OverlayStateSchema,\r\n  OverlayEvent\r\n>(\r\n  {\r\n    id: 'overlay',\r\n    initial: 'closed',\r\n    context: { initialState: 'CLOSED' },\r\n    states: {\r\n      closed: { on: { OPEN: 'opening', CLOSE: undefined } },\r\n      opening: {\r\n        initial: 'start',\r\n        states: {\r\n          start: {\r\n            invoke: {\r\n              src: 'onOpenStart',\r\n              onDone: 'transition',\r\n            },\r\n          },\r\n          transition: {\r\n            always: [\r\n              { target: 'immediately', cond: 'initiallyOpen' },\r\n              { target: 'smoothly', cond: 'initiallyClosed' },\r\n            ],\r\n          },\r\n          immediately: {\r\n            initial: 'open',\r\n            states: {\r\n              open: {\r\n                invoke: { src: 'openImmediately', onDone: 'activating' },\r\n              },\r\n              activating: {\r\n                invoke: { src: 'activate', onDone: '#overlay.opening.end' },\r\n                on: { ...openToDrag, ...openToResize },\r\n              },\r\n            },\r\n          },\r\n          smoothly: {\r\n            initial: 'visuallyHidden',\r\n            states: {\r\n              visuallyHidden: {\r\n                invoke: { src: 'renderVisuallyHidden', onDone: 'activating' },\r\n              },\r\n              activating: {\r\n                invoke: { src: 'activate', onDone: 'open' },\r\n              },\r\n              open: {\r\n                invoke: { src: 'openSmoothly', onDone: '#overlay.opening.end' },\r\n                on: { ...openToDrag, ...openToResize },\r\n              },\r\n            },\r\n          },\r\n          end: {\r\n            invoke: { src: 'onOpenEnd', onDone: 'done' },\r\n            on: { CLOSE: '#overlay.closing', DRAG: '#overlay.dragging' },\r\n          },\r\n          done: {\r\n            type: 'final',\r\n          },\r\n        },\r\n        on: { ...cancelOpen },\r\n        onDone: 'open',\r\n      },\r\n      open: {\r\n        on: { DRAG: '#overlay.dragging', SNAP: 'snapping', RESIZE: 'resizing' },\r\n      },\r\n      dragging: {\r\n        on: { SNAP: 'snapping' },\r\n      },\r\n      snapping: {\r\n        initial: 'start',\r\n        states: {\r\n          start: {\r\n            invoke: {\r\n              src: 'onSnapStart',\r\n              onDone: 'snappingSmoothly',\r\n            },\r\n            entry: [\r\n              assign({\r\n                // @ts-expect-error\r\n                y: (_, { payload: { y } }) => y,\r\n                // @ts-expect-error\r\n                velocity: (_, { payload: { velocity } }) => velocity,\r\n                // @ts-expect-error\r\n                snapSource: (_, { payload: { source = 'custom' } }) => source,\r\n              }),\r\n            ],\r\n          },\r\n          snappingSmoothly: {\r\n            invoke: { src: 'snapSmoothly', onDone: 'end' },\r\n          },\r\n          end: {\r\n            invoke: { src: 'onSnapEnd', onDone: 'done' },\r\n            on: {\r\n              RESIZE: '#overlay.resizing',\r\n              SNAP: '#overlay.snapping',\r\n              CLOSE: '#overlay.closing',\r\n              DRAG: '#overlay.dragging',\r\n            },\r\n          },\r\n          done: { type: 'final' },\r\n        },\r\n        on: {\r\n          SNAP: { target: 'snapping', actions: 'onSnapEnd' },\r\n          RESIZE: { target: '#overlay.resizing', actions: 'onSnapCancel' },\r\n          DRAG: { target: '#overlay.dragging', actions: 'onSnapCancel' },\r\n          CLOSE: { target: '#overlay.closing', actions: 'onSnapCancel' },\r\n        },\r\n        onDone: 'open',\r\n      },\r\n      resizing: {\r\n        initial: 'start',\r\n        states: {\r\n          start: {\r\n            invoke: {\r\n              src: 'onResizeStart',\r\n              onDone: 'resizingSmoothly',\r\n            },\r\n          },\r\n          resizingSmoothly: {\r\n            invoke: { src: 'resizeSmoothly', onDone: 'end' },\r\n          },\r\n          end: {\r\n            invoke: { src: 'onResizeEnd', onDone: 'done' },\r\n            on: {\r\n              SNAP: '#overlay.snapping',\r\n              CLOSE: '#overlay.closing',\r\n              DRAG: '#overlay.dragging',\r\n            },\r\n          },\r\n          done: { type: 'final' },\r\n        },\r\n        on: {\r\n          RESIZE: { target: 'resizing', actions: 'onResizeEnd' },\r\n          SNAP: { target: 'snapping', actions: 'onResizeCancel' },\r\n          DRAG: { target: '#overlay.dragging', actions: 'onResizeCancel' },\r\n          CLOSE: { target: '#overlay.closing', actions: 'onResizeCancel' },\r\n        },\r\n        onDone: 'open',\r\n      },\r\n      closing: {\r\n        initial: 'start',\r\n        states: {\r\n          start: {\r\n            invoke: {\r\n              src: 'onCloseStart',\r\n              onDone: 'deactivating',\r\n            },\r\n            on: { OPEN: { target: '#overlay.open', actions: 'onCloseCancel' } },\r\n          },\r\n          deactivating: {\r\n            invoke: { src: 'deactivate', onDone: 'closingSmoothly' },\r\n          },\r\n          closingSmoothly: {\r\n            invoke: { src: 'closeSmoothly', onDone: 'end' },\r\n          },\r\n          end: {\r\n            invoke: { src: 'onCloseEnd', onDone: 'done' },\r\n            on: {\r\n              OPEN: { target: '#overlay.opening', actions: 'onCloseCancel' },\r\n            },\r\n          },\r\n          done: { type: 'final' },\r\n        },\r\n        on: {\r\n          CLOSE: undefined,\r\n          OPEN: { target: '#overlay.opening', actions: 'onCloseCancel' },\r\n        },\r\n        onDone: 'closed',\r\n      },\r\n    },\r\n    on: {\r\n      CLOSE: 'closing',\r\n    },\r\n  },\r\n  {\r\n    actions: {\r\n      onOpenCancel: (context, event) => {},\r\n      onSnapCancel: (context, event) => {},\r\n      onResizeCancel: (context, event) => {},\r\n      onCloseCancel: (context, event) => {},\r\n      onOpenEnd: (context, event) => {},\r\n      onSnapEnd: (context, event) => {},\r\n      onResizeEnd: (context, event) => {},\r\n    },\r\n    services: {\r\n      onSnapStart: async () => {\r\n        await sleep()\r\n      },\r\n      onOpenStart: async () => {\r\n        await sleep()\r\n      },\r\n      onCloseStart: async () => {\r\n        await sleep()\r\n      },\r\n      onResizeStart: async () => {\r\n        await sleep()\r\n      },\r\n      onSnapEnd: async () => {\r\n        await sleep()\r\n      },\r\n      onOpenEnd: async () => {\r\n        await sleep()\r\n      },\r\n      onCloseEnd: async () => {\r\n        await sleep()\r\n      },\r\n      onResizeEnd: async () => {\r\n        await sleep()\r\n      },\r\n      renderVisuallyHidden: async (context, event) => {\r\n        await sleep()\r\n      },\r\n      activate: async (context, event) => {\r\n        await sleep()\r\n      },\r\n      deactivate: async (context, event) => {\r\n        await sleep()\r\n      },\r\n      openSmoothly: async (context, event) => {\r\n        await sleep()\r\n      },\r\n      openImmediately: async (context, event) => {\r\n        await sleep()\r\n      },\r\n      snapSmoothly: async (context, event) => {\r\n        await sleep()\r\n      },\r\n      resizeSmoothly: async (context, event) => {\r\n        await sleep()\r\n      },\r\n      closeSmoothly: async (context, event) => {\r\n        await sleep()\r\n      },\r\n    },\r\n    guards: { initiallyClosed, initiallyOpen },\r\n  },\r\n)\r\n","//\r\n// In order to greatly reduce complexity this component is designed to always transition to open on mount, and then\r\n// transition to a closed state later. This ensures that all memory used to keep track of animation and gesture state\r\n// can be reclaimed after the sheet is closed and then unmounted.\r\n// It also ensures that when transitioning to open on mount the state is always clean, not affected by previous states that could\r\n// cause race conditions.\r\n\r\nimport { useMachine } from '@xstate/react'\r\nimport React, {\r\n  useCallback,\r\n  useEffect,\r\n  useImperativeHandle,\r\n  useRef,\r\n} from 'react'\r\nimport { animated, config } from 'react-spring'\r\nimport { rubberbandIfOutOfBounds, useDrag } from 'react-use-gesture'\r\nimport {\r\n  useAriaHider,\r\n  useFocusTrap,\r\n  useLayoutEffect,\r\n  useReady,\r\n  useReducedMotion,\r\n  useScrollLock,\r\n  useSnapPoints,\r\n  useSpring,\r\n  useSpringInterpolations,\r\n} from './hooks'\r\nimport { overlayMachine } from './machines/overlay'\r\nimport type {\r\n  defaultSnapProps,\r\n  Props,\r\n  RefHandles,\r\n  ResizeSource,\r\n  SnapPointProps,\r\n} from './types'\r\nimport { debugging } from './utils'\r\n\r\nconst { tension, friction } = config.default\r\n\r\n// @TODO implement AbortController to deal with race conditions\r\n\r\n// @TODO rename to SpringBottomSheet and allow userland to import it directly, for those who want maximum control and minimal bundlesize\r\nexport const BottomSheet = React.forwardRef<\r\n  RefHandles,\r\n  {\r\n    initialState: 'OPEN' | 'CLOSED'\r\n    lastSnapRef: React.MutableRefObject<number | null>\r\n  } & Props\r\n>(function BottomSheetInternal(\r\n  {\r\n    children,\r\n    sibling,\r\n    className,\r\n    footer,\r\n    header,\r\n    open: _open,\r\n    initialState,\r\n    lastSnapRef,\r\n    initialFocusRef,\r\n    onDismiss,\r\n    maxHeight: controlledMaxHeight,\r\n    defaultSnap: getDefaultSnap = _defaultSnap,\r\n    snapPoints: getSnapPoints = _snapPoints,\r\n    blocking = true,\r\n    scrollLocking = true,\r\n    style,\r\n    onSpringStart,\r\n    onSpringCancel,\r\n    onSpringEnd,\r\n    reserveScrollBarGap = blocking,\r\n    expandOnContentDrag = false,\r\n    disableExpandList = [],\r\n    preventPullUp = false,\r\n    ...props\r\n  },\r\n  forwardRef\r\n) {\r\n  // Before any animations can start we need to measure a few things, like the viewport and the dimensions of content, and header + footer if they exist\r\n  // @TODO make ready its own state perhaps, before open or closed\r\n  const { ready, registerReady } = useReady()\r\n\r\n  // Controls the drag handler, used by spring operations that happen outside the render loop in React\r\n  const canDragRef = useRef(false)\r\n\r\n  // This way apps don't have to remember to wrap their callbacks in useCallback to avoid breaking the sheet\r\n  const onSpringStartRef = useRef(onSpringStart)\r\n  const onSpringCancelRef = useRef(onSpringCancel)\r\n  const onSpringEndRef = useRef(onSpringEnd)\r\n  useEffect(() => {\r\n    onSpringStartRef.current = onSpringStart\r\n    onSpringCancelRef.current = onSpringCancel\r\n    onSpringEndRef.current = onSpringEnd\r\n  }, [onSpringCancel, onSpringStart, onSpringEnd])\r\n\r\n  // Behold, the engine of it all!\r\n  const [spring, set] = useSpring()\r\n\r\n  const containerRef = useRef<HTMLDivElement>(null)\r\n  const scrollRef = useRef<HTMLDivElement>(null)\r\n  const contentRef = useRef<HTMLDivElement>(null)\r\n  const headerRef = useRef<HTMLDivElement>(null)\r\n  const footerRef = useRef<HTMLDivElement>(null)\r\n  const overlayRef = useRef<HTMLDivElement | null>(null)\r\n\r\n  // Keeps track of the current height, or the height transitioning to\r\n  const heightRef = useRef(0)\r\n  const resizeSourceRef = useRef<ResizeSource>()\r\n  const preventScrollingRef = useRef(false)\r\n\r\n  const prefersReducedMotion = useReducedMotion()\r\n\r\n  // \"Plugins\" huhuhu\r\n  const scrollLockRef = useScrollLock({\r\n    targetRef: scrollRef,\r\n    enabled: ready && scrollLocking,\r\n    reserveScrollBarGap,\r\n  })\r\n  const ariaHiderRef = useAriaHider({\r\n    targetRef: containerRef,\r\n    enabled: ready && blocking,\r\n  })\r\n  const focusTrapRef = useFocusTrap({\r\n    targetRef: containerRef,\r\n    fallbackRef: overlayRef,\r\n    initialFocusRef: initialFocusRef || undefined,\r\n    enabled: ready && blocking && initialFocusRef !== false,\r\n  })\r\n\r\n  const { minSnap, maxSnap, maxHeight, findSnap } = useSnapPoints({\r\n    contentRef,\r\n    controlledMaxHeight,\r\n    footerEnabled: !!footer,\r\n    footerRef,\r\n    getSnapPoints,\r\n    headerEnabled: header !== false,\r\n    headerRef,\r\n    heightRef,\r\n    lastSnapRef,\r\n    ready,\r\n    registerReady,\r\n    resizeSourceRef,\r\n  })\r\n\r\n  // Setup refs that are used in cases where full control is needed over when a side effect is executed\r\n  const maxHeightRef = useRef(maxHeight)\r\n  const minSnapRef = useRef(minSnap)\r\n  const maxSnapRef = useRef(maxSnap)\r\n  const findSnapRef = useRef(findSnap)\r\n  const defaultSnapRef = useRef(0)\r\n  // Sync the refs with current state, giving the spring full control over when to respond to changes\r\n  useLayoutEffect(() => {\r\n    maxHeightRef.current = maxHeight\r\n    maxSnapRef.current = maxSnap\r\n    minSnapRef.current = minSnap\r\n    findSnapRef.current = findSnap\r\n    defaultSnapRef.current = findSnap(getDefaultSnap)\r\n  }, [findSnap, getDefaultSnap, maxHeight, maxSnap, minSnap])\r\n\r\n  // New utility for using events safely\r\n  const asyncSet = useCallback<typeof set>(\r\n    // @ts-ignore\r\n    ({ onRest, config: { velocity = 1, ...config } = {}, ...opts }) =>\r\n      // @ts-expect-error\r\n      new Promise((resolve) =>\r\n        set({\r\n          ...opts,\r\n          config: {\r\n            velocity,\r\n            ...config,\r\n            // @see https://springs.pomb.us\r\n            mass: 1,\r\n            // \"stiffness\"\r\n            tension,\r\n            // \"damping\"\r\n            friction: Math.max(\r\n              friction,\r\n              friction + (friction - friction * velocity)\r\n            ),\r\n          },\r\n          onRest: (...args) => {\r\n            // @ts-expect-error\r\n            resolve(...args)\r\n            onRest?.(...args)\r\n          },\r\n        })\r\n      ),\r\n    [set]\r\n  )\r\n  const [current, send] = useMachine(overlayMachine, {\r\n    devTools: debugging,\r\n    actions: {\r\n      onOpenCancel: useCallback(\r\n        () => onSpringCancelRef.current?.({ type: 'OPEN' }),\r\n        []\r\n      ),\r\n      onSnapCancel: useCallback(\r\n        (context) =>\r\n          onSpringCancelRef.current?.({\r\n            type: 'SNAP',\r\n            source: context.snapSource,\r\n          }),\r\n        []\r\n      ),\r\n      onCloseCancel: useCallback(\r\n        () => onSpringCancelRef.current?.({ type: 'CLOSE' }),\r\n        []\r\n      ),\r\n      onResizeCancel: useCallback(\r\n        () =>\r\n          onSpringCancelRef.current?.({\r\n            type: 'RESIZE',\r\n            source: resizeSourceRef.current,\r\n          }),\r\n        []\r\n      ),\r\n      onOpenEnd: useCallback(\r\n        () => onSpringEndRef.current?.({ type: 'OPEN' }),\r\n        []\r\n      ),\r\n      onSnapEnd: useCallback(\r\n        (context, event) =>\r\n          onSpringEndRef.current?.({\r\n            type: 'SNAP',\r\n            source: context.snapSource,\r\n          }),\r\n        []\r\n      ),\r\n      onResizeEnd: useCallback(\r\n        () =>\r\n          onSpringEndRef.current?.({\r\n            type: 'RESIZE',\r\n            source: resizeSourceRef.current,\r\n          }),\r\n        []\r\n      ),\r\n    },\r\n    context: { initialState },\r\n    services: {\r\n      onSnapStart: useCallback(\r\n        async (context, event) =>\r\n          onSpringStartRef.current?.({\r\n            type: 'SNAP',\r\n            source: event.payload.source || 'custom',\r\n          }),\r\n        []\r\n      ),\r\n      onOpenStart: useCallback(\r\n        async () => onSpringStartRef.current?.({ type: 'OPEN' }),\r\n        []\r\n      ),\r\n      onCloseStart: useCallback(\r\n        async () => onSpringStartRef.current?.({ type: 'CLOSE' }),\r\n        []\r\n      ),\r\n      onResizeStart: useCallback(\r\n        async () =>\r\n          onSpringStartRef.current?.({\r\n            type: 'RESIZE',\r\n            source: resizeSourceRef.current,\r\n          }),\r\n        []\r\n      ),\r\n      onSnapEnd: useCallback(\r\n        async (context, event) =>\r\n          onSpringEndRef.current?.({\r\n            type: 'SNAP',\r\n            source: context.snapSource,\r\n          }),\r\n        []\r\n      ),\r\n      onOpenEnd: useCallback(\r\n        async () => onSpringEndRef.current?.({ type: 'OPEN' }),\r\n        []\r\n      ),\r\n      onCloseEnd: useCallback(\r\n        async () => onSpringEndRef.current?.({ type: 'CLOSE' }),\r\n        []\r\n      ),\r\n      onResizeEnd: useCallback(\r\n        async () =>\r\n          onSpringEndRef.current?.({\r\n            type: 'RESIZE',\r\n            source: resizeSourceRef.current,\r\n          }),\r\n        []\r\n      ),\r\n      renderVisuallyHidden: useCallback(\r\n        async (context, event) => {\r\n          await asyncSet({\r\n            y: defaultSnapRef.current,\r\n            ready: 0,\r\n            maxHeight: maxHeightRef.current,\r\n            maxSnap: maxSnapRef.current,\r\n            // Using defaultSnapRef instead of minSnapRef to avoid animating `height` on open\r\n            minSnap: defaultSnapRef.current,\r\n            immediate: true,\r\n          })\r\n        },\r\n        [asyncSet]\r\n      ),\r\n      activate: useCallback(\r\n        async (context, event) => {\r\n          canDragRef.current = true\r\n          await Promise.all([\r\n            scrollLockRef.current.activate(),\r\n            focusTrapRef.current.activate(),\r\n            ariaHiderRef.current.activate(),\r\n          ])\r\n        },\r\n        [ariaHiderRef, focusTrapRef, scrollLockRef]\r\n      ),\r\n      deactivate: useCallback(async () => {\r\n        scrollLockRef.current.deactivate()\r\n        focusTrapRef.current.deactivate()\r\n        ariaHiderRef.current.deactivate()\r\n        canDragRef.current = false\r\n      }, [ariaHiderRef, focusTrapRef, scrollLockRef]),\r\n      openImmediately: useCallback(async () => {\r\n        heightRef.current = defaultSnapRef.current\r\n        await asyncSet({\r\n          y: defaultSnapRef.current,\r\n          ready: 1,\r\n          maxHeight: maxHeightRef.current,\r\n          maxSnap: maxSnapRef.current,\r\n          // Using defaultSnapRef instead of minSnapRef to avoid animating `height` on open\r\n          minSnap: defaultSnapRef.current,\r\n          immediate: true,\r\n        })\r\n      }, [asyncSet]),\r\n      openSmoothly: useCallback(async () => {\r\n        await asyncSet({\r\n          y: 0,\r\n          ready: 1,\r\n          maxHeight: maxHeightRef.current,\r\n          maxSnap: maxSnapRef.current,\r\n          // Using defaultSnapRef instead of minSnapRef to avoid animating `height` on open\r\n          minSnap: defaultSnapRef.current,\r\n          immediate: true,\r\n        })\r\n\r\n        heightRef.current = defaultSnapRef.current\r\n\r\n        await asyncSet({\r\n          y: defaultSnapRef.current,\r\n          ready: 1,\r\n          maxHeight: maxHeightRef.current,\r\n          maxSnap: maxSnapRef.current,\r\n          // Using defaultSnapRef instead of minSnapRef to avoid animating `height` on open\r\n          minSnap: defaultSnapRef.current,\r\n          immediate: prefersReducedMotion.current,\r\n        })\r\n      }, [asyncSet, prefersReducedMotion]),\r\n      snapSmoothly: useCallback(\r\n        async (context, event) => {\r\n          const snap = findSnapRef.current(context.y)\r\n          heightRef.current = snap\r\n          lastSnapRef.current = snap\r\n          await asyncSet({\r\n            y: snap,\r\n            ready: 1,\r\n            maxHeight: maxHeightRef.current,\r\n            maxSnap: maxSnapRef.current,\r\n            minSnap: minSnapRef.current,\r\n            immediate: prefersReducedMotion.current,\r\n            config: { velocity: context.velocity },\r\n          })\r\n        },\r\n        [asyncSet, lastSnapRef, prefersReducedMotion]\r\n      ),\r\n      resizeSmoothly: useCallback(async () => {\r\n        const snap = findSnapRef.current(heightRef.current)\r\n        heightRef.current = snap\r\n        lastSnapRef.current = snap\r\n        await asyncSet({\r\n          y: snap,\r\n          ready: 1,\r\n          maxHeight: maxHeightRef.current,\r\n          maxSnap: maxSnapRef.current,\r\n          minSnap: minSnapRef.current,\r\n          immediate:\r\n            resizeSourceRef.current === 'element'\r\n              ? prefersReducedMotion.current\r\n              : true,\r\n        })\r\n      }, [asyncSet, lastSnapRef, prefersReducedMotion]),\r\n      closeSmoothly: useCallback(\r\n        async (context, event) => {\r\n          // Avoid animating the height property on close and stay within FLIP bounds by upping the minSnap\r\n          asyncSet({\r\n            minSnap: heightRef.current,\r\n            immediate: true,\r\n          })\r\n\r\n          heightRef.current = 0\r\n\r\n          await asyncSet({\r\n            y: 0,\r\n            maxHeight: maxHeightRef.current,\r\n            maxSnap: maxSnapRef.current,\r\n            immediate: prefersReducedMotion.current,\r\n          })\r\n\r\n          await asyncSet({ ready: 0, immediate: true })\r\n        },\r\n        [asyncSet, prefersReducedMotion]\r\n      ),\r\n    },\r\n  })\r\n\r\n  useEffect(() => {\r\n    if (_open) {\r\n      send('OPEN')\r\n    } else {\r\n      send('CLOSE')\r\n    }\r\n  }, [_open, send, ready])\r\n  useLayoutEffect(() => {\r\n    // Adjust the height whenever the snap points are changed due to resize events\r\n    if (maxHeight || maxSnap || minSnap) {\r\n      send('RESIZE')\r\n    }\r\n  }, [maxHeight, maxSnap, minSnap, send])\r\n  useEffect(\r\n    () => () => {\r\n      // Ensure effects are cleaned up on unmount, in case they're not cleaned up otherwise\r\n      scrollLockRef.current.deactivate()\r\n      focusTrapRef.current.deactivate()\r\n      ariaHiderRef.current.deactivate()\r\n    },\r\n    [ariaHiderRef, focusTrapRef, scrollLockRef]\r\n  )\r\n\r\n  useImperativeHandle(\r\n    forwardRef,\r\n    () => ({\r\n      snapTo: (numberOrCallback, { velocity = 1, source = 'custom' } = {}) => {\r\n        send('SNAP', {\r\n          payload: {\r\n            y: findSnapRef.current(numberOrCallback),\r\n            velocity,\r\n            source,\r\n          },\r\n        })\r\n      },\r\n      get height() {\r\n        return heightRef.current\r\n      },\r\n    }),\r\n    [send]\r\n  )\r\n\r\n  useEffect(() => {\r\n    const elem = scrollRef.current\r\n\r\n    const preventScrolling = e => {\r\n      const disableExpandListNodes = disableExpandList.map(selector => containerRef.current.querySelector(selector)).filter(Boolean);\r\n      if (disableExpandListNodes.length && disableExpandListNodes.some(disableNode => disableNode.contains(e.target))) {\r\n        return true\r\n      } else if (preventScrollingRef.current && elem.scrollTop <= 0) {\r\n        e.preventDefault()\r\n      }\r\n    }\r\n\r\n    let prevValue = 0;\r\n    const preventSafariOverscrollOnStart = e => {\r\n      if (elem.scrollTop < 0) {\r\n        prevValue = elem.scrollTop;\r\n      }\r\n    }\r\n  \r\n    const preventSafariOverscrollOnMove = (e) => {\r\n      if (elem.scrollTop < 0 && elem.scrollTop < prevValue) {\r\n        e.preventDefault();\r\n      }\r\n    };\r\n\r\n    if (expandOnContentDrag) {\r\n      elem.addEventListener('scroll', preventScrolling)\r\n      elem.addEventListener('touchmove', preventScrolling)\r\n      elem.addEventListener('touchmove', preventSafariOverscrollOnMove);\r\n      elem.addEventListener('touchstart', preventSafariOverscrollOnStart, {\r\n        passive: true\r\n      });\r\n    }\r\n    return () => {\r\n      elem.removeEventListener('scroll', preventScrolling)\r\n      elem.removeEventListener('touchmove', preventScrolling)\r\n      elem.removeEventListener('touchmove', preventSafariOverscrollOnMove);\r\n      elem.removeEventListener('touchstart', preventSafariOverscrollOnStart);\r\n    }\r\n  }, [expandOnContentDrag, scrollRef, disableExpandList])\r\n\r\n  const handleDrag = ({\r\n    args: [{ closeOnTap = false, isContentDragging = false } = {}] = [],\r\n    cancel,\r\n    direction: [, direction],\r\n    down,\r\n    first,\r\n    last,\r\n    memo = spring.y.get(),\r\n    movement: [, _my],\r\n    tap,\r\n    velocity,\r\n    event,\r\n  }) => {\r\n    const my = _my * -1\r\n    const hasScroll = scrollRef.current.scrollHeight > scrollRef.current.clientHeight;\r\n    if (containerRef.current && disableExpandList.length) {\r\n      const disableExpandListNodes = disableExpandList.map(selector => containerRef.current.querySelector(selector)).filter(Boolean);\r\n      if (disableExpandListNodes.length && disableExpandListNodes.some(disableNode => disableNode.contains(event.target))) {\r\n        cancel()\r\n        return memo\r\n      }\r\n    }\r\n    \r\n    // Cancel the drag operation if the canDrag state changed\r\n    if (!canDragRef.current) {\r\n      cancel()\r\n      return memo\r\n    }\r\n\r\n    if (onDismiss && closeOnTap && tap) {\r\n      cancel()\r\n      // Runs onDismiss in a timeout to avoid tap events on the backdrop from triggering click events on elements underneath\r\n      setTimeout(() => onDismiss(), 10)\r\n      return memo\r\n    }\r\n\r\n    // Filter out taps\r\n    if (tap) {\r\n      return memo\r\n    }\r\n\r\n    const rawY = memo + my\r\n    const predictedDistance = my * velocity\r\n    const predictedY = Math.max(\r\n      minSnapRef.current,\r\n      Math.min(maxSnapRef.current, rawY + predictedDistance * 2)\r\n    )\r\n\r\n    if (\r\n      !down &&\r\n      onDismiss &&\r\n      direction > 0 &&\r\n      rawY + predictedDistance < minSnapRef.current / 2\r\n      && (!hasScroll || scrollRef.current.scrollTop <= 0)\r\n    ) {\r\n      cancel()\r\n      onDismiss()\r\n      return memo\r\n    }\r\n\r\n    let newY = down\r\n      ? // @TODO figure out a better way to deal with rubberband overshooting if min and max have the same value\r\n        !onDismiss && minSnapRef.current === maxSnapRef.current\r\n        ? rawY < minSnapRef.current\r\n          ? rubberbandIfOutOfBounds(\r\n              rawY,\r\n              minSnapRef.current,\r\n              maxSnapRef.current * 2,\r\n              0.55\r\n            )\r\n          : rubberbandIfOutOfBounds(\r\n              rawY,\r\n              minSnapRef.current / 2,\r\n              maxSnapRef.current,\r\n              0.55\r\n            )\r\n        : rubberbandIfOutOfBounds(\r\n            rawY,\r\n            onDismiss ? 0 : minSnapRef.current,\r\n            maxSnapRef.current,\r\n            0.55\r\n          )\r\n      : predictedY\r\n    \r\n    if (preventPullUp) {\r\n      if (direction === 0) {\r\n        return memo\r\n      }\r\n      if ((direction < 0 && newY > maxSnap && _my <= 0) || (direction > 0 && newY > maxSnap && _my <= 0)) {\r\n        // realize feature: all pop-ups shouldn't be pulled up by certain if it is fully open\r\n        // if direction up, and newY coordinate >= maxSnap, and distance Y from start point to current point (_my) <= 0 don't change height modal\r\n        // or if direction down, and newY coordinate >= maxSnap, and distance Y from start point to current point (_my) <= 0 don't change height modal\r\n        return memo;\r\n      }\r\n    }\r\n\r\n    if (expandOnContentDrag && isContentDragging) {\r\n      if (newY >= maxSnapRef.current) {\r\n        newY = maxSnapRef.current\r\n      }\r\n\r\n      if (memo === maxSnapRef.current && scrollRef.current.scrollTop > 0) {\r\n        newY = maxSnapRef.current\r\n      }\r\n\r\n      preventScrollingRef.current = newY < maxSnapRef.current;\r\n    } else {\r\n      preventScrollingRef.current = false\r\n    }\r\n\r\n    if (first) {\r\n      send('DRAG')\r\n    }\r\n\r\n    if (last) {\r\n      send('SNAP', {\r\n        payload: {\r\n          y: newY,\r\n          velocity: velocity > 0.05 ? velocity : 1,\r\n          source: 'dragging',\r\n        },\r\n      })\r\n\r\n      return memo\r\n    }\r\n\r\n    // @TODO too many rerenders\r\n    //send('DRAG', { y: newY, velocity })\r\n    //*\r\n    set({\r\n      y: newY,\r\n      ready: 1,\r\n      maxHeight: maxHeightRef.current,\r\n      maxSnap: maxSnapRef.current,\r\n      minSnap: minSnapRef.current,\r\n      immediate: true,\r\n      config: { velocity },\r\n    })\r\n    // */\r\n\r\n    return memo\r\n  }\r\n\r\n  const bind = useDrag(handleDrag, {\r\n    filterTaps: true,\r\n  })\r\n\r\n  if (Number.isNaN(maxSnapRef.current)) {\r\n    throw new TypeError('maxSnapRef is NaN!!')\r\n  }\r\n  if (Number.isNaN(minSnapRef.current)) {\r\n    throw new TypeError('minSnapRef is NaN!!')\r\n  }\r\n\r\n  const interpolations = useSpringInterpolations({ spring })\r\n\r\n  return (\r\n    <animated.div\r\n      {...props}\r\n      data-rsbs-root\r\n      data-rsbs-state={publicStates.find(current.matches)}\r\n      data-rsbs-is-blocking={blocking}\r\n      data-rsbs-is-dismissable={!!onDismiss}\r\n      data-rsbs-has-header={!!header}\r\n      data-rsbs-has-footer={!!footer}\r\n      className={className}\r\n      ref={containerRef}\r\n      style={{\r\n        // spread in the interpolations yeees\r\n        ...interpolations,\r\n        // but allow overriding them/disabling them\r\n        ...style,\r\n        // Not overridable as the \"focus lock with opacity 0\" trick rely on it\r\n        // @TODO the line below only fails on TS <4\r\n        // @ts-ignore\r\n        opacity: spring.ready,\r\n      }}\r\n    >\r\n      {sibling}\r\n      {blocking && (\r\n        <div\r\n          // This component needs to be placed outside bottom-sheet, as bottom-sheet uses transform and thus creates a new context\r\n          // that clips this element to the container, not allowing it to cover the full page.\r\n          key=\"backdrop\"\r\n          data-rsbs-backdrop\r\n          {...bind({ closeOnTap: true })}\r\n        />\r\n      )}\r\n      <div\r\n        key=\"overlay\"\r\n        aria-modal=\"true\"\r\n        role=\"dialog\"\r\n        data-rsbs-overlay\r\n        tabIndex={-1}\r\n        ref={overlayRef}\r\n        onKeyDown={(event) => {\r\n          if (event.key === 'Escape') {\r\n            // Always stop propagation, to avoid weirdness for bottom sheets inside other bottom sheets\r\n            event.stopPropagation()\r\n            if (onDismiss) onDismiss()\r\n          }\r\n        }}\r\n      >\r\n        {header !== false && (\r\n          <div key=\"header\" data-rsbs-header ref={headerRef} {...bind()}>\r\n            {header}\r\n          </div>\r\n        )}\r\n        <div key=\"scroll\" data-rsbs-scroll ref={scrollRef} {...(expandOnContentDrag ? bind({ isContentDragging: true }) : {})}>\r\n          <div data-rsbs-content ref={contentRef}>\r\n            {children}\r\n          </div>\r\n        </div>\r\n        {footer && (\r\n          <div key=\"footer\" ref={footerRef} data-rsbs-footer {...bind()}>\r\n            {footer}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </animated.div>\r\n  )\r\n})\r\n\r\n// Used for the data attribute, list over states available to CSS selectors\r\nconst publicStates = [\r\n  'closed',\r\n  'opening',\r\n  'open',\r\n  'closing',\r\n  'dragging',\r\n  'snapping',\r\n  'resizing',\r\n]\r\n\r\n// Default prop values that are callbacks, and it's nice to save some memory and reuse their instances since they're pure\r\nfunction _defaultSnap({ snapPoints, lastSnap }: defaultSnapProps) {\r\n  return lastSnap ?? Math.min(...snapPoints)\r\n}\r\nfunction _snapPoints({ minHeight }: SnapPointProps) {\r\n  return minHeight\r\n}\r\n","// Keeps track of wether everything is good to go or not, in the most efficient way possible\r\n\r\nimport { useCallback, useEffect, useState } from 'react'\r\n\r\nexport function useReady() {\r\n  const [ready, setReady] = useState(false)\r\n  const [readyMap, updateReadyMap] = useState<{ [key: string]: boolean }>({})\r\n\r\n  const registerReady = useCallback((key: string) => {\r\n    // Register the check we're gonna wait for until it's ready\r\n    updateReadyMap((ready) => ({ ...ready, [key]: false }))\r\n\r\n    return () => {\r\n      // Set it to ready\r\n      updateReadyMap((ready) => ({ ...ready, [key]: true }))\r\n    }\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    const states = Object.values(readyMap)\r\n\r\n    if (states.length === 0) {\r\n      return\r\n    }\r\n\r\n    const isReady = states.every(Boolean)\r\n    if (isReady) {\r\n      setReady(true)\r\n    }\r\n  }, [readyMap])\r\n\r\n  return { ready, registerReady }\r\n}\r\n","import { useDebugValue, useEffect, useMemo, useRef } from 'react'\r\n\r\n// @TODO refactor to addEventListener\r\nexport function useReducedMotion() {\r\n  const mql = useMemo(\r\n    () =>\r\n      typeof window !== 'undefined'\r\n        ? window.matchMedia('(prefers-reduced-motion: reduce)')\r\n        : null,\r\n    []\r\n  )\r\n  const ref = useRef(mql?.matches)\r\n\r\n  useDebugValue(ref.current ? 'reduce' : 'no-preference')\r\n\r\n  useEffect(() => {\r\n    const handler = (event) => {\r\n      ref.current = event.matches\r\n    }\r\n    mql?.addListener(handler)\r\n\r\n    return () => mql?.removeListener(handler)\r\n  }, [mql])\r\n\r\n  return ref\r\n}\r\n","import { useSpring as useReactSpring } from 'react-spring'\r\n\r\n// Behold, the engine of it all!\r\n// Put in this file befause it makes it easier to type and I'm lazy! :D\r\n\r\nexport function useSpring() {\r\n  return useReactSpring(() => ({\r\n    y: 0,\r\n    ready: 0,\r\n    maxHeight: 0,\r\n    minSnap: 0,\r\n    maxSnap: 0,\r\n  }))\r\n}\r\n\r\nexport type Spring = ReturnType<typeof useSpring>[0]\r\nexport type SpringSet = ReturnType<typeof useSpring>[1]\r\n","import { disableBodyScroll, enableBodyScroll } from 'body-scroll-lock'\r\nimport { useDebugValue, useEffect, useRef } from 'react'\r\n\r\n/**\r\n * Handle scroll locking to ensure a good dragging experience on Android and iOS.\r\n *\r\n * On iOS the following may happen if scroll isn't locked:\r\n * - When dragging the sheet the background gets dragged at the same time.\r\n * - When dragging the page scroll is also affected, causing the drag to feel buggy and \"slow\".\r\n *\r\n * On Android it causes the chrome toolbar to pop down as you drag down, and hide as you drag up.\r\n * When it's in between two toolbar states it causes the framerate to drop way below 60fps on\r\n * the bottom sheet drag interaction.\r\n */\r\nexport function useScrollLock({\r\n  targetRef,\r\n  enabled,\r\n  reserveScrollBarGap,\r\n}: {\r\n  targetRef: React.RefObject<Element>\r\n  enabled: boolean\r\n  reserveScrollBarGap: boolean\r\n}) {\r\n  const ref = useRef<{ activate: () => void; deactivate: () => void }>({\r\n    activate: () => {\r\n      throw new TypeError('Tried to activate scroll lock too early')\r\n    },\r\n    deactivate: () => {},\r\n  })\r\n\r\n  useDebugValue(enabled ? 'Enabled' : 'Disabled')\r\n\r\n  useEffect(() => {\r\n    if (!enabled) {\r\n      ref.current.deactivate()\r\n      ref.current = { activate: () => {}, deactivate: () => {} }\r\n      return\r\n    }\r\n\r\n    const target = targetRef.current\r\n    let active = false\r\n\r\n    ref.current = {\r\n      activate: () => {\r\n        if (active) return\r\n        active = true\r\n        disableBodyScroll(target, {\r\n          allowTouchMove: (el) => el.closest('[data-body-scroll-lock-ignore]'),\r\n          reserveScrollBarGap,\r\n        })\r\n      },\r\n      deactivate: () => {\r\n        if (!active) return\r\n        active = false\r\n        enableBodyScroll(target)\r\n      },\r\n    }\r\n  }, [enabled, targetRef, reserveScrollBarGap])\r\n\r\n  return ref\r\n}\r\n","import React, { useDebugValue, useEffect, useRef } from 'react'\r\n\r\n// Handle hiding and restoring aria-hidden attributes\r\nexport function useAriaHider({\r\n  targetRef,\r\n  enabled,\r\n}: {\r\n  targetRef: React.RefObject<Element>\r\n  enabled: boolean\r\n}) {\r\n  const ref = useRef<{ activate: () => void; deactivate: () => void }>({\r\n    activate: () => {\r\n      throw new TypeError('Tried to activate aria hider too early')\r\n    },\r\n    deactivate: () => {},\r\n  })\r\n\r\n  useDebugValue(enabled ? 'Enabled' : 'Disabled')\r\n\r\n  useEffect(() => {\r\n    if (!enabled) {\r\n      ref.current.deactivate()\r\n      ref.current = { activate: () => {}, deactivate: () => {} }\r\n      return\r\n    }\r\n\r\n    const target = targetRef.current\r\n    let active = false\r\n    let originalValues: (null | string)[] = []\r\n    let rootNodes: Element[] = []\r\n\r\n    ref.current = {\r\n      activate: () => {\r\n        if (active) return\r\n        active = true\r\n\r\n        const parentNode = target.parentNode\r\n\r\n        document.querySelectorAll('body > *').forEach((node) => {\r\n          if (node === parentNode) {\r\n            return\r\n          }\r\n          let attr = node.getAttribute('aria-hidden')\r\n          let alreadyHidden = attr !== null && attr !== 'false'\r\n          if (alreadyHidden) {\r\n            return\r\n          }\r\n          originalValues.push(attr)\r\n          rootNodes.push(node)\r\n          node.setAttribute('aria-hidden', 'true')\r\n        })\r\n      },\r\n      deactivate: () => {\r\n        if (!active) return\r\n        active = false\r\n\r\n        rootNodes.forEach((node, index) => {\r\n          let originalValue = originalValues[index]\r\n          if (originalValue === null) {\r\n            node.removeAttribute('aria-hidden')\r\n          } else {\r\n            node.setAttribute('aria-hidden', originalValue)\r\n          }\r\n        })\r\n        originalValues = []\r\n        rootNodes = []\r\n      },\r\n    }\r\n  }, [targetRef, enabled])\r\n\r\n  return ref\r\n}\r\n","import { createFocusTrap } from 'focus-trap'\r\nimport { useDebugValue, useEffect, useRef } from 'react'\r\n\r\nexport function useFocusTrap({\r\n  targetRef,\r\n  fallbackRef,\r\n  initialFocusRef,\r\n  enabled,\r\n}: {\r\n  targetRef: React.RefObject<HTMLElement>\r\n  fallbackRef: React.RefObject<HTMLElement>\r\n  initialFocusRef?: React.RefObject<HTMLElement>\r\n  enabled: boolean\r\n}) {\r\n  const ref = useRef<{ activate: () => void; deactivate: () => void }>({\r\n    activate: () => {\r\n      throw new TypeError('Tried to activate focus trap too early')\r\n    },\r\n    deactivate: () => {},\r\n  })\r\n\r\n  useDebugValue(enabled ? 'Enabled' : 'Disabled')\r\n\r\n  useEffect(() => {\r\n    if (!enabled) {\r\n      ref.current.deactivate()\r\n      ref.current = { activate: () => {}, deactivate: () => {} }\r\n      return\r\n    }\r\n\r\n    const fallback = fallbackRef.current\r\n    const trap = createFocusTrap(targetRef.current, {\r\n      onActivate:\r\n        process.env.NODE_ENV !== 'production'\r\n          ? () => {\r\n            }\r\n          : undefined,\r\n      // If initialFocusRef is manually specified we don't want the first tabbable element to receive focus if initialFocusRef can't be found\r\n      initialFocus: initialFocusRef\r\n        ? () => initialFocusRef?.current || fallback\r\n        : undefined,\r\n      fallbackFocus: fallback,\r\n      escapeDeactivates: false,\r\n      clickOutsideDeactivates: false,\r\n    })\r\n    let active = false\r\n\r\n    ref.current = {\r\n      activate: async () => {\r\n        if (active) return\r\n        active = true\r\n\r\n        await trap.activate()\r\n        // it's difficult to know exactly when focus is udpated https://github.com/focus-trap/focus-trap/blob/036a72ec48b85414dda00ec0c40d631c8f0ae5ce/index.js#L369-L371\r\n        // This timeout is attempting to compromise between a reasonable guess, as well as not delaying the open transition more than necessary\r\n        await new Promise((resolve) => setTimeout(() => resolve(void 1), 0))\r\n      },\r\n      deactivate: () => {\r\n        if (!active) return\r\n        active = false\r\n\r\n        trap.deactivate()\r\n      },\r\n    }\r\n  }, [enabled, fallbackRef, initialFocusRef, targetRef])\r\n\r\n  return ref\r\n}\r\n","import { to } from 'react-spring'\r\nimport type { Spring } from './useSpring'\r\nimport { clamp } from '../utils'\r\n\r\nexport function useSpringInterpolations({\r\n  spring,\r\n}: {\r\n  spring: Spring\r\n}): React.CSSProperties {\r\n  const interpolateBorderRadius = to(\r\n    [spring.y, spring.maxHeight],\r\n    (y, maxHeight) => {\r\n      return `${Math.round(clamp(maxHeight - y, 0, 16))}px`\r\n    },\r\n  )\r\n\r\n  const interpolateHeight = to(\r\n    [spring.y, spring.minSnap, spring.maxSnap],\r\n    (y, minSnap, maxSnap) => `${Math.round(clamp(y, minSnap, maxSnap))}px`,\r\n  )\r\n\r\n  const finalHeight = `${Math.round(spring.maxSnap.get())}px`\r\n\r\n  const interpolateY = to(\r\n    [spring.y, spring.minSnap, spring.maxSnap],\r\n    (y, minSnap, maxSnap) => {\r\n      if (y < minSnap) {\r\n        return `${Math.round(minSnap - y)}px`\r\n      }\r\n      if (y > maxSnap) {\r\n        return `${Math.round(maxSnap - y)}px`\r\n      }\r\n      return '0px'\r\n    },\r\n  )\r\n\r\n  const interpolateFiller = to([spring.y, spring.maxSnap], (y, maxSnap) => {\r\n    if (y >= maxSnap) {\r\n      return Math.ceil(y - maxSnap)\r\n    }\r\n    return 0\r\n  })\r\n\r\n  const interpolateContentOpacity = to(\r\n    [spring.y, spring.minSnap],\r\n    (y, minSnap) => {\r\n      if (!minSnap) {\r\n        return 0\r\n      }\r\n      const minX = Math.max(minSnap / 2 - 45, 0)\r\n      const maxX = Math.min(minSnap / 2 + 45, minSnap)\r\n      const minY = 0\r\n      const maxY = 1\r\n\r\n      const slope = (maxY - minY) / (maxX - minX)\r\n      const res = (y - minX) * (slope + minY)\r\n      return clamp(res, 0, 1)\r\n    },\r\n  )\r\n\r\n  const interpolateBackdrop = to([spring.y, spring.minSnap], (y, minSnap) =>\r\n    minSnap ? clamp(y / minSnap, 0, 1) : 0,\r\n  )\r\n\r\n  return {\r\n    ['--rsbs-content-opacity' as any]: interpolateContentOpacity,\r\n    ['--rsbs-backdrop-opacity' as any]: interpolateBackdrop,\r\n    ['--rsbs-antigap-scale-y' as any]: interpolateFiller,\r\n    ['--rsbs-overlay-translate-y' as any]: interpolateY,\r\n    ['--rsbs-overlay-rounded' as any]: interpolateBorderRadius,\r\n    ['--rsbs-overlay-h' as any]: interpolateHeight,\r\n    ['--fag-height' as any]: finalHeight,\r\n  }\r\n}\r\n","/* eslint-disable react/jsx-pascal-case */\r\nimport * as Portal from '@radix-ui/react-portal';\r\nimport React, { forwardRef, useRef, useState, useCallback } from 'react'\r\nimport { BottomSheet as _BottomSheet } from './BottomSheet'\r\nimport type { Props, RefHandles, SpringEvent } from './types'\r\nimport { useLayoutEffect } from './hooks'\r\n\r\nexport type {\r\n  RefHandles as BottomSheetRef,\r\n  Props as BottomSheetProps,\r\n} from './types'\r\n\r\n// Because SSR is annoying to deal with, and all the million complaints about window, navigator and dom elenents!\r\nexport const BottomSheet = forwardRef<RefHandles, Props>(function BottomSheet(\r\n  { onSpringStart, onSpringEnd, skipInitialTransition, ...props },\r\n  ref\r\n) {\r\n  const timerRef = useRef<ReturnType<typeof requestAnimationFrame>>()\r\n  const lastSnapRef = useRef(null)\r\n  // @TODO refactor to an initialState: OPEN | CLOSED property as it's much easier to understand\r\n  // And informs what we should animate from. If the sheet is mounted with open = true, then initialState = OPEN.\r\n  // When initialState = CLOSED, then internal sheet must first render with open={false} before setting open={props.open}\r\n  // It's only when initialState and props.open is mismatching that a intial transition should happen\r\n  // If they match then transitions will only happen when a user interaction or resize event happen.\r\n  const initialStateRef = useRef<'OPEN' | 'CLOSED'>(\r\n    skipInitialTransition && props.open ? 'OPEN' : 'CLOSED'\r\n  )\r\n\r\n  // Using layout effect to support cases where the bottom sheet have to appear already open, no transition\r\n  useLayoutEffect(() => {\r\n    if (props.open) {\r\n      cancelAnimationFrame(timerRef.current)\r\n\r\n      // Cleanup defaultOpen state on close\r\n      return () => {\r\n        initialStateRef.current = 'CLOSED'\r\n      }\r\n    }\r\n  }, [props.open])\r\n\r\n  const handleSpringStart = useCallback(\r\n    async function handleSpringStart(event: SpringEvent) {\r\n      // Forward the event\r\n      await onSpringStart?.(event)\r\n\r\n      if (event.type === 'OPEN') {\r\n        // Ensures that when it's opening we abort any pending unmount action\r\n        cancelAnimationFrame(timerRef.current)\r\n      }\r\n    },\r\n    [onSpringStart]\r\n  )\r\n\r\n  const handleSpringEnd = useCallback(\r\n    async function handleSpringEnd(event: SpringEvent) {\r\n      // Forward the event\r\n      await onSpringEnd?.(event)\r\n    },\r\n    [onSpringEnd]\r\n  )\r\n\r\n  return (\r\n    <Portal.Root data-rsbs-portal>\r\n      <_BottomSheet\r\n        {...props}\r\n        lastSnapRef={lastSnapRef}\r\n        ref={ref}\r\n        initialState={initialStateRef.current}\r\n        onSpringStart={handleSpringStart}\r\n        onSpringEnd={handleSpringEnd}\r\n      />\r\n    </Portal.Root>\r\n  )\r\n})\r\n"],"names":["useLayoutEffect","window","useLayoutEffectSafely","useEffect","clamp","number","lower","upper","roundAndCheckForNaN","unrounded","rounded","Math","round","Number","isNaN","TypeError","observerOptions","box","useElementSizeObserver","ref","_ref3","label","enabled","resizeSourceRef","_useState","useState","size","setSize","useDebugValue","handleResize","useCallback","entries","borderBoxSize","blockSize","current","resizeObserver","ResizeObserver","observe","disconnect","sleep","ms","Promise","resolve","setTimeout","openToDrag","DRAG","target","actions","openToResize","RESIZE","overlayMachine","Machine","id","initial","context","initialState","states","closed","on","OPEN","CLOSE","undefined","opening","start","invoke","src","onDone","transition","always","cond","immediately","open","activating","_extends","smoothly","visuallyHidden","end","done","type","SNAP","dragging","snapping","entry","assign","y","_","payload","velocity","_ref4","snapSource","_ref5","_ref5$payload$source","source","snappingSmoothly","resizing","resizingSmoothly","closing","deactivating","closingSmoothly","onOpenCancel","event","onSnapCancel","onResizeCancel","onCloseCancel","onOpenEnd","onSnapEnd","onResizeEnd","services","onSnapStart","then","e","reject","onOpenStart","onCloseStart","onResizeStart","onCloseEnd","renderVisuallyHidden","activate","deactivate","openSmoothly","openImmediately","snapSmoothly","resizeSmoothly","closeSmoothly","guards","initiallyClosed","_ref2","initiallyOpen","_ref","_config$default","config","default","tension","friction","BottomSheet","React","forwardRef","children","sibling","className","footer","header","_open","lastSnapRef","initialFocusRef","onDismiss","controlledMaxHeight","maxHeight","_ref$defaultSnap","defaultSnap","getDefaultSnap","_defaultSnap","_ref$snapPoints","snapPoints","getSnapPoints","_snapPoints","_ref$blocking","blocking","_ref$scrollLocking","scrollLocking","style","onSpringStart","onSpringCancel","onSpringEnd","_ref$reserveScrollBar","reserveScrollBarGap","_ref$expandOnContentD","expandOnContentDrag","_ref$disableExpandLis","disableExpandList","_ref$preventPullUp","preventPullUp","props","_objectWithoutPropertiesLoose","_excluded","_useReady","ready","setReady","_useState2","readyMap","updateReadyMap","registerReady","key","_extends2","_extends3","Object","values","length","every","Boolean","useReady","canDragRef","useRef","onSpringStartRef","onSpringCancelRef","onSpringEndRef","mql","_useSpring","useReactSpring","minSnap","maxSnap","spring","set","containerRef","scrollRef","contentRef","headerRef","footerRef","overlayRef","heightRef","preventScrollingRef","prefersReducedMotion","useMemo","matchMedia","matches","handler","addListener","removeListener","scrollLockRef","targetRef","active","disableBodyScroll","allowTouchMove","el","closest","enableBodyScroll","useScrollLock","ariaHiderRef","originalValues","rootNodes","parentNode","document","querySelectorAll","forEach","node","attr","getAttribute","push","setAttribute","index","originalValue","removeAttribute","useAriaHider","focusTrapRef","fallbackRef","fallback","trap","createFocusTrap","onActivate","initialFocus","fallbackFocus","escapeDeactivates","clickOutsideDeactivates","useFocusTrap","_useSnapPoints","_useDimensions","footerEnabled","headerEnabled","innerHeight","setMaxHeight","raf","requestAnimationFrame","addEventListener","removeEventListener","cancelAnimationFrame","useMaxHeight","headerHeight","contentHeight","footerHeight","minHeight","min","useDimensions","_processSnapPoints","unsafeSnaps","snapPointsDedupedSet","concat","map","reduce","acc","snapPoint","add","Set","Array","from","apply","max","processSnapPoints","height","findSnap","numberOrCallback","querySnap","lastSnap","prev","curr","abs","useSnapPoints","maxHeightRef","minSnapRef","maxSnapRef","findSnapRef","defaultSnapRef","asyncSet","onRest","_ref2$config","_ref2$config$velocity","_excluded2","opts","_excluded3","mass","args","slice","call","arguments","_useMachine","useMachine","devTools","immediate","all","snap","send","useImperativeHandle","snapTo","_temp","_ref3$velocity","_ref3$source","elem","preventScrolling","disableExpandListNodes","selector","querySelector","filter","some","disableNode","contains","scrollTop","preventDefault","prevValue","preventSafariOverscrollOnStart","preventSafariOverscrollOnMove","passive","bind","useDrag","_ref4$args$","_ref4$args","_ref4$args$$closeOnTa","closeOnTap","_ref4$args$$isContent","isContentDragging","cancel","direction","down","first","last","_ref4$memo","memo","get","_my","movement","tap","my","hasScroll","scrollHeight","clientHeight","rawY","predictedDistance","predictedY","newY","rubberbandIfOutOfBounds","filterTaps","interpolations","interpolateBorderRadius","to","interpolateHeight","finalHeight","interpolateY","interpolateFiller","ceil","interpolateContentOpacity","minX","interpolateBackdrop","useSpringInterpolations","createElement","animated","div","publicStates","find","opacity","role","tabIndex","onKeyDown","stopPropagation","_ref6","skipInitialTransition","timerRef","initialStateRef","handleSpringStart","handleSpringEnd","Portal","Root","_BottomSheet"],"mappings":"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"}